extends layout

block content
  h2 Passe o cursor e clique na região de interesse para selecionar o capítulo

  form.panel(name='funcao', method='POST', action='#{address}')
    input#id(type='hidden', name='id', value='#{id}')
    script.
      setCanvasObject = function($canvas, image, action) {
        $canvas.first = true;
        $canvas.out = true;
        console.log("canvas ", $canvas);
        loadCanvasImage($canvas, image);

        $canvas.on('mouseover', function(e) {
          if (isTransparentUnderMouse(this, e)) {
            setTimeout(function() { $('.my-tooltip').hide(); }, 0);
          }
        });

        $canvas.on('mousemove', function(e) {
          if (!isTransparentUnderMouse(this, e)) {
            if ($canvas.first) {
              $('.my-tooltip').show();
              $canvas.first = false;
            }
            if ($canvas.out) {
              $('.my-tooltip').show();
              $canvas.out = false;
            }
            return true;
          }
          else
          {
            if (!$canvas.out) {
              $('.my-tooltip').hide();
              $canvas.out = true;
            }
            return true;
          }
        });

        $canvas.on('mouseleave', function(e) {
          $('.my-tooltip').hide();
          $canvas.out = true;
        });

        $canvas.on('click', function(e) {
          sendAction(this, action);
        });
      };

    if sex == 'm'
      div#man.left-container
        h1.topic Funções do corpo
        div#map(width="300px", height="622px")
          canvas(width="300px", height="622px", title="Funções da pele e estruturas relacionadas")
          script.
            $(function() {
              var $canvas = $("div#man.left-container > div > canvas");
              setCanvasObject($canvas, '/images/man_small.png', 'b8');
            });

          input#b1(type='submit', name='chapters',
            onclick='return sendAction(this);', value='',
            title='Funções mentais')

          input#b2(type='submit', name='chapters',
            onclick='return sendAction(this);', value='',
            title='Funções sensoriais')

          input#b3(type='submit', name='chapters',
            onclick='return sendAction(this);', value='',
            title='Funções da voz e da fala')

          input#b4(type='submit', name='chapters',
            onclick='return sendAction(this);', value='',
            title='Funções dos sistemas cardiovascular, hematológico, imunológico, respiratório')

          input#b5(type='submit', name='chapters',
            onclick='return sendAction(this);', value='',
            title='Funções dos sistemas digestivo, metabólico e endócrino')

          input#b6(type='submit', name='chapters',
            onclick='return sendAction(this);', value='',
            title='Funções geniturinárias e reprodutivas')

          input#b7(type='submit', name='chapters',
            onclick='return sendAction(this);', value='',
            title='Funções neuromusculo-esqueléticas e relacionadas ao movimento')

    else if sex == 'f'
      div#woman.left-container
        h1.topic Funções do corpo
        div#map(width="300px", height="622px")
          canvas(width="300px", height="622px", title="Funções da pele e estruturas relacionadas")
          script.
            $(function() {
              var $canvas = $("div#woman.left-container > div > canvas");
              setCanvasObject($canvas, '/images/woman_small.png', 'b8');
            });

          input#b1(type='submit', name='chapters',
            onclick='return sendAction(this);', value='',
            title='Funções mentais')

          input#b2(type='submit', name='chapters',
            onclick='return sendAction(this);', value='',
            title='Funções sensoriais')

          input#b3(type='submit', name='chapters',
            onclick='return sendAction(this);', value='',
            title='Funções da voz e da fala')

          input#b4(type='submit', name='chapters',
            onclick='return sendAction(this);', value='',
            title='Funções dos sistemas cardiovascular, hematológico, imunológico, respiratório')

          input#b5(type='submit', name='chapters',
            onclick='return sendAction(this);', value='',
            title='Funções dos sistemas digestivo, metabólico e endócrino')

          input#b6(type='submit', name='chapters',
            onclick='return sendAction(this);', value='',
            title='Funções geniturinárias e reprodutivas')

          input#b7(type='submit', name='chapters',
            onclick='return sendAction(this);', value='',
            title='Funções neuromusculo-esqueléticas e relacionadas ao movimento')

    if sex == 'm'
      div#man.middle-container
        h1.topic Estruturas do corpo
        div#map(width="300px", height="622px")
          canvas(width="300px", height="622px", title="Pele e estruturas relacionadas")
          script.
            $(function() {
              var $canvas = $("div#man.middle-container > div > canvas");
              setCanvasObject($canvas, '/images/man_small.png', 's8');
            });

          input#s1(type='submit', name='chapters',
            onclick='return sendAction(this);', value='',
            title='Estruturas do sistema nervoso')

          input#s2(type='submit', name='chapters',
            onclick='return sendAction(this);', value='',
            title='Olhos, ouvidos e estruturas relacionadas')

          input#s3(type='submit', name='chapters',
            onclick='return sendAction(this);', value='',
            title='Estruturas relacionadas à voz e fala')

          input#s4(type='submit', name='chapters',
            onclick='return sendAction(this);', value='',
            title='Estruturas dos sistemas cardiovascular, imunológico e respiratório')

          input#s5(type='submit', name='chapters',
            onclick='return sendAction(this);', value='',
            title='Estruturas relacionadas ao sistema digestório, metabólico e endócrino')

          input#s6(type='submit', name='chapters',
            onclick='return sendAction(this);', value='',
            title='Estruturas relacionadas aos sistema gerinuritário e reprodutivo')

          input#s7(type='submit', name='chapters',
            onclick='return sendAction(this);', value='',
            title='Estruturas relacionadas ao movimento')

          input#s8(type='submit', name='chapters',
            onclick='return sendAction(this);', value='',
            title='Pele e estruturas relacionadas')

    else if sex == 'f'
      div#woman.middle-container
        h1.topic Estruturas do corpo
        div#map(width="300px", height="622px")
          canvas(width="300px", height="622px", title="Pele e estruturas relacionadas")
          script.
            $(function() {
              var $canvas = $("div#woman.middle-container > div > canvas");
              setCanvasObject($canvas, '/images/woman_small.png', 's8');
            });

          input#s1(type='submit', name='chapters',
            onclick='return sendAction(this);', value='',
            title='Estruturas do sistema nervoso')

          input#s2(type='submit', name='chapters',
            onclick='return sendAction(this);', value='',
            title='Olhos, ouvidos e estruturas relacionadas')

          input#s3(type='submit', name='chapters',
            onclick='return sendAction(this);', value='',
            title='Estruturas relacionadas à voz e fala')

          input#s4(type='submit', name='chapters',
            onclick='return sendAction(this);', value='',
            title='Estruturas dos sistemas cardiovascular, imunológico e respiratório')

          input#s5(type='submit', name='chapters',
            onclick='return sendAction(this);', value='',
            title='Estruturas relacionadas ao sistema digestório, metabólico e endócrino')

          input#s6(type='submit', name='chapters',
            onclick='return sendAction(this);', value='',
            title='Estruturas relacionadas aos sistema gerinuritário e reprodutivo')

          input#s7(type='submit', name='chapters',
            onclick='return sendAction(this);', value='',
            title='Estruturas relacionadas ao movimento')

    script.
      $(function() {
        $(document).tooltip({ track : true, tooltipClass: "my-tooltip" });
      });
